# Application Configuration
spring.application.name=afrostyle-monolith
server.port=7777

# Database Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/afrostyle_db?createDatabaseIfNotExist=true&allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=Mascotte1993&
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA Configuration
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
spring.jpa.properties.hibernate.format_sql=true
# Ignore les colonnes orphelines lors des migrations mono-salon
hibernate.hbm2ddl.extra_physical_table_types=TABLE


# Security Configuration - EXTERNALIZED (CRITICAL SECURITY)
# Note: Configuration moved to app.security.* prefix for consistency

# application.properties
# spring.cloud.azure.keyvault.secret.property-sources[0].endpoint=https://secretkeyvaultjb.vault.azure.net/



# Security Secrets Configuration - AZURE KEYVAULT UNIQUEMENT (NO FALLBACKS)
# JWT configuration removed - using SESSION-BASED authentication

app.security.stripe.secret-key=${StripeSecret}
app.security.stripe.publishable-key=${StripePublique}
app.security.stripe.webhook-secret=whsec_5d5e7218ff6520b55e55b5645342cb3271290e00b642054ea39f0eecb488c0dc

# Stripe API and Webhook Version Management
stripe.api.version=2025-06-30.basil
stripe.webhook.migration.enabled=false
stripe.webhook.migration.process-legacy=true
stripe.webhook.migration.process-new=false

# Redis Configuration (Optional - disable if Redis not available)
redis.enabled=false
spring.data.redis.repositories.enabled=false

# Disable Redis health check to prevent application failure
management.health.redis.enabled=false

# Redis connection settings (only used when redis.enabled=true)
spring.data.redis.host=localhost
spring.data.redis.port=6379
spring.data.redis.password=
spring.data.redis.database=0
spring.data.redis.timeout=2000ms
spring.data.redis.lettuce.pool.max-active=8
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=0

app.security.email.username=${EMAIL-USERNAME:}
app.security.email.password=${EMAIL-PASSWORD:}

app.security.twilio.account-sid=${TWILIO-ACCOUNT-SID:}
app.security.twilio.auth-token=${TWILIO-AUTH-TOKEN:}
app.security.twilio.phone-number=${TWILIO-PHONE-NUMBER:}

app.security.google.client-secret=${GOOGLE-CLIENT-SECRET:}
app.security.google.maps-api-key=${GOOGLE-MAPS-API-KEY:}

# Actuator Configuration
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=always
management.health.db.enabled=true
management.health.mail.enabled=false

# Email Configuration - AZURE KEYVAULT UNIQUEMENT
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${EMAIL-USERNAME:noreply@afrostyle.be}
spring.mail.password=${EMAIL-PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
email.from=${EMAIL-FROM:noreply@afrostyle.be}
email.from-name=${EMAIL-FROM-NAME:AfroStyle}

# SMS Configuration (Twilio) - AZURE KEYVAULT UNIQUEMENT (NO FALLBACKS)
twilio.account-sid=${TWILIO-ACCOUNT-SID:}
twilio.auth-token=${TWILIO-AUTH-TOKEN:}
twilio.phone-number=${TWILIO-PHONE-NUMBER:}
sms.enabled=${SMS-ENABLED:false}

# Payment Configuration (Stripe) - DEPRECATED
# Configuration moved to app.security.stripe.* (see lines 31-33)

# Google OAuth2 Configuration - DÉSACTIVÉ (sera activé via Azure KeyVault si nécessaire)
# Pour activer OAuth2 Google, ajoutez GOOGLE-CLIENT-ID et GOOGLE-CLIENT-SECRET dans Azure KeyVault

# Google Services Configuration - AZURE KEYVAULT UNIQUEMENT (NO FALLBACKS)
google.calendar.enabled=${GOOGLE-CALENDAR-ENABLED:false}
google.calendar.timezone=${GOOGLE-CALENDAR-TIMEZONE:Europe/Brussels}
google.maps.api-key=${GOOGLE-MAPS-API-KEY:}
google.maps.enabled=${GOOGLE-MAPS-ENABLED:false}

# Logging Configuration
logging.level.root=INFO
logging.level.com.jb.afrostyle=INFO
logging.level.org.springframework.security=WARN
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Jackson Configuration
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC

# File Upload Configuration
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB

# Frontend URLs Configuration - Externalized for all environments
app.frontend.base-url=${FRONTEND_BASE_URL:http://localhost:4200}
app.frontend.payment.success-url=${PAYMENT_SUCCESS_URL:${app.frontend.base-url}/payment/success}
app.frontend.payment.cancel-url=${PAYMENT_CANCEL_URL:${app.frontend.base-url}/payment/cancel}

# CORS Configuration - Externalized for security
app.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:4200,http://localhost:3000,https://afrostyle.be,https://*.afrostyle.be}
app.cors.allowed-methods=${CORS_ALLOWED_METHODS:GET,POST,PUT,PATCH,DELETE,OPTIONS}
app.cors.allowed-headers=${CORS_ALLOWED_HEADERS:Authorization,Content-Type,X-Requested-With,Accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers}
app.cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:true}
app.cors.max-age=${CORS_MAX_AGE:3600}

# Google Maps API Configuration - Externalized
google.maps.api.geocode-url=${GOOGLE_GEOCODE_URL:https://maps.googleapis.com/maps/api/geocode/json}
google.maps.api.static-map-url=${GOOGLE_STATICMAP_URL:https://maps.googleapis.com/maps/api/staticmap}
google.maps.api.directions-url=${GOOGLE_DIRECTIONS_URL:https://www.google.com/maps/dir/?api=1&destination=}
google.maps.api.enabled=${GOOGLE_MAPS_ENABLED:false}
google.maps.api.default-zoom=${GOOGLE_MAPS_DEFAULT_ZOOM:15}

# Azure KeyVault Configuration
spring.cloud.azure.keyvault.secret.property-sources[0].endpoint=https://secretkeyvaultjb.vault.azure.net/
spring.cloud.azure.keyvault.secret.property-sources[0].name=afrostyle-keyvault
spring.cloud.azure.keyvault.secret.property-sources[0].case-sensitive=false
spring.config.import=optional:azure-keyvault://

# Application Configuration - AZURE KEYVAULT UNIQUEMENT
# Note: Les propriétés avec fallbacks ci-dessus permettent un fonctionnement 
# même si certains secrets optionnels ne sont pas définis dans Azure KeyVault


